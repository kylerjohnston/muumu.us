---
title: TiddlyWiki user authentication with nginx auth_requests and Django
date: 2020-11-14
layout: post
excerpt:
tags:
- tiddlywiki
- django
- nginx
- public-notes
---

In September, I created [public-notes.muumu.us](https://public-notes.muumu.us
"public-notes.muumu.us"), a project to create a personal knowledge base/notebook
and publish it on the public internet. I chose
[TiddlyWiki](https://tiddlywiki.com/ "TiddlyWiki") as the software for the
notebook for reasons I outlined in an earlier post, [Building an internet-facing
TiddlyWiki for my public second brain]({% post_url
2020-09-06-building-a-public-tiddlywiki %} "Building an internet-facing
TiddlyWiki for my public second brain - muumu.us"). TiddlyWiki's
non-heirarchical approach to note taking is unique, especially in the free
software world, and I find its ergonomics mesh much better with my thought
process than a traditional wiki or something like Evernote. TiddlyWiki is one of
a very few pieces of software that feels completely effortless to use, like it's
just an extension of my brain.

So I chose TiddlyWiki for the project for its great user interface, despite some
other deficiencies that made it a less than ideal choice, like only supporting
HTTP basic authentication. Over the past couple months, the basic auth has come
to be a real pain point. I use Firefox for a browser and Bitwarden as a password
manager, on both desktop and mobile, and the user experience for getting through
basic auth is frustrating. The basic auth window steals the focus and prevents
you from clicking back into the browser, like you'd need to do to grab your
password from the Bitwarden plugin, so you need to remember to copy the password
*before* navigating to the site --- and since you're not already on the site,
Bitwarden won't autosuggest it and you'll have to search for it. If you forget
to perform that ritual you will have to cancel out of the basic auth window,
perform the rite, and try an incantation of hard refreshes and new private
windows to get the authentication box to reappear --- on the occasional
concerning refresh the page will simply load without even prompting to
authenticate. On mobile this whole performance is painful enough that I stopped
using it, and the only reason I put it on the internet to begin with was to more
easily access it via my phone.

There has to be a better way to do this. You will find
[twproxy](https://github.com/stevenleeg/twproxy "stevenleeg/twproxy - GitHub")
suggested on the TiddlyWiki Google Group. It's a Ruby/Sinatra application that
proxies requests to TiddlyWiki and adds authentication. It sounded like a good
solution, but I ran into a problem described [in an issue on the project's
GitHub](https://github.com/stevenleeg/twproxy/issues/6 "TW returning 403 on
attempted save") where the TiddlyWiki would only render for an instant before
throwing a `Sync error while processing '$:/StoryList'`. I spent an hour or so
starting to fix it last Saturday, but fixing that one bug revealed another and I
started falling down a rabbit hole of trying to fix outdated dependencies. I
became demotivated when I saw there was already an open PR on the project that
purported to fix the issue that had been open and untouched for 3 months ---
although, for what it's worth, I couldn't get that PR's branch working either,
and there are no tests.

Ultimately, twproxy didn't seem like the right approach to me anyway. I already have nginx set up as a reverse proxy on TiddlyWiki. 
